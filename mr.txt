
Step 1: On your host (Windows)

Create a folder,

C:\cloudera_share


Step 2: In VirtualBox settings (before starting VM)

Go to Settings → Shared Folders → Add new folder icon (+)

Folder Path → browse to C:\cloudera_share

Check:

Auto-mount

Make Permanent

Start the VM.

cd ~
mkdir -p /media/sf_cloudera_share
sudo mount -t vboxsf sf_cloudera_share /media/sf_cloudera_share
mkdir -p ~/wordcount_py
cd ~/wordcount_py

cat > input.txt <<EOF
Hadoop is simple
Hadoop is powerful
Hadoop runs everywhere
EOF

nano mapper.py
mapper.py
#!/usr/bin/env python
import sys
for line in sys.stdin:
    for word in line.strip().split():
        print(f"{word}\t1")


nano reducer.py
reducer.py
#!/usr/bin/env python
import sys
current_word = None
current_count = 0
for line in sys.stdin:
    word, count = line.strip().split('\t')
    count = int(count)
    if word == current_word:
        current_count += count
    else:
        if current_word:
            print(f"{current_word}\t{current_count}")
        current_word = word
        current_count = count
if current_word:
    print(f"{current_word}\t{current_count}")




chmod +x mapper.py reducer.py
cat input.txt | ./mapper.py | sort | ./reducer.py

hdfs dfs -mkdir -p /user/cloudera/input
hdfs dfs -put -f input.txt /user/cloudera/input/
hdfs dfs -rm -r /user/cloudera/output_py

hadoop jar /usr/lib/hadoop-mapreduce/hadoop-streaming.jar \
-files mapper.py,reducer.py \
-input /user/cloudera/input \
-output /user/cloudera/output_py \
-mapper mapper.py \
-reducer reducer.py

hdfs dfs -cat /user/cloudera/output_py/part-00000
